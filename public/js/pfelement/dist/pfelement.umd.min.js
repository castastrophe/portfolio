!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).PFElement=t()}(this,function(){"use strict";var r=function(){return null};function n(){r("[reveal] web components ready"),r("[reveal] elements ready, revealing the body"),window.document.body.removeAttribute("unresolved")}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0==n)return!1;var o,i,t=0|t,a=Math.max(0<=t?t:n-Math.abs(t),0);for(;a<n;){if((o=r[a])===(i=e)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;a++}return!1}}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=new Array(r);r--;)n[r]=[t[r],e[t[r]]];return n});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},h=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},f="pfe",e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,HTMLElement),e(p,[{key:"log",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p.log("["+this.tag+(this.id?"#"+this.id:"")+"]: "+t.join(", "))}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p.warn("["+this.tag+(this.id?"#"+this.id:"")+"]: "+t.join(", "))}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];p.error.apply(p,["["+this.tag+(this.id?"#"+this.id:"")+"]:"].concat(t))}},{key:"hasLightDOM",value:function(){return this.children.length||this.textContent.trim().length}},{key:"hasSlot",value:function(t){var e=this;if(t)switch(void 0===t?"undefined":s(t)){case"string":return 0<[].concat(c(this.children)).filter(function(e){return e.hasAttribute("slot")&&e.getAttribute("slot")===t}).length;case"array":return t.reduce(function(t){return 0<[].concat(c(e.children)).filter(function(e){return e.hasAttribute("slot")&&e.getAttribute("slot")===t}).length});default:return void this.warn("Did not recognize the type of the name provided to hasSlot; this funciton can accept a string or an array.")}else this.warn("Please provide at least one slot name for which to search.")}},{key:"getSlot",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"unassigned";return"unassigned"!==t?[].concat(c(this.children)).filter(function(e){return e.hasAttribute("slot")&&e.getAttribute("slot")===t}):[].concat(c(this.children)).filter(function(e){return!e.hasAttribute("slot")})}},{key:"cssVariable",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this;return e="--"!==e.substr(0,2)?"--"+e:e,t?(r.style.setProperty(e,t),t):window.getComputedStyle(r).getPropertyValue(e).trim()||null}},{key:"contextUpdate",value:function(){var t=this;[].concat(c(this.querySelectorAll("*")),c(this.shadowRoot.querySelectorAll("*"))).filter(function(e){return e.tagName.toLowerCase().slice(0,4)===f+"-"}).map(function(e){t.log("Update context of "+e.tag),Promise.all([customElements.whenDefined(e.tagName.toLowerCase())]).then(function(){e.resetContext(t.on)})})}},{key:"resetContext",value:function(e){this.log("Resetting context on "+this.tag);e=this.context||this.contextVariable||e;this.on=e}},{key:"version",get:function(){return this._pfeClass.version}},{key:"randomId",get:function(){return f+"-"+Math.random().toString(36).substr(2,9)}},{key:"contextVariable",set:function(e){this.cssVariable("context",e)},get:function(){return this.cssVariable("context")||this.cssVariable("theme")}}],[{key:"debugLog",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return p._debugLog=null!==e?!!e:p._debugLog}},{key:"log",value:function(){var e;p.debugLog()&&(e=console).log.apply(e,arguments)}},{key:"warn",value:function(){var e;(e=console).warn.apply(e,arguments)}},{key:"error",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];throw new Error([].concat(t).join(" "))}},{key:"PfeTypes",get:function(){return{Container:"container",Content:"content",Combo:"combo"}}},{key:"version",get:function(){return"{{version}}"}},{key:"properties",get:function(){return{pfelement:{title:"Upgraded flag",type:Boolean,default:!0,observer:"_upgradeObserver"},on:{title:"Context",description:"Describes the visual context (backgrounds).",type:String,values:["light","dark","saturated"],default:function(e){return e.contextVariable},observer:"_onObserver"},context:{title:"Context hook",description:"Lets you override the system-set context.",type:String,values:["light","dark","saturated"],observer:"_contextObserver"},oldTheme:{type:String,values:["light","dark","saturated"],alias:"context",attr:"pfe-theme"},_style:{title:"Custom styles",type:String,attr:"style",observer:"_inlineStyleObserver"},type:{title:"Component type",type:String,values:["container","content","combo"]}}}},{key:"observedAttributes",get:function(){var t=this,r=this.allProperties;if(r){var e=Object.keys(r).filter(function(e){return r[e].observer||r[e].cascade||r[e].alias}).map(function(e){return t._convertPropNameToAttrName(e)});return[].concat(c(e))}}}]),e(p,[{key:"connectedCallback",value:function(){var e=this;this._initializeAttributeDefaults(),window.ShadyCSS&&window.ShadyCSS.styleElement(this),"object"===s(this.slots)&&(this._slotsObserver=new MutationObserver(function(){return e._initializeSlots(e.tag,e.slots)}),this._slotsObserver.observe(this,{childList:!0}),this._initializeSlots(this.tag,this.slots)),this._cascadeObserver&&this._cascadeObserver.observe(this,{attributes:!0,childList:!0,subtree:!0})}},{key:"disconnectedCallback",value:function(){this._cascadeObserver&&this._cascadeObserver.disconnect(),this._slotsObserver&&this._slotsObserver.disconnect()}},{key:"attributeChangedCallback",value:function(e,t,r){var n,o,i;this._pfeClass.allProperties&&(i=this._pfeClass._attr2prop(e),(n=this._pfeClass.allProperties[i])&&(n.alias&&(o=this._pfeClass.allProperties[n.alias],i=this._pfeClass._prop2attr(n.alias),this.getAttribute(i)!==r&&(this[n.alias]=this._castPropertyValue(o,r))),n.observer&&this[n.observer](this._castPropertyValue(n,t),this._castPropertyValue(n,r)),n.cascade&&this._copyAttribute(e,this._pfeClass._convertSelectorsToArray(n.cascade))))}},{key:"render",value:function(){this.shadowRoot.innerHTML="",this.template.innerHTML=this.html,window.ShadyCSS&&window.ShadyCSS.prepareTemplate(this.template,this.tag),this.shadowRoot.appendChild(this.template.content.cloneNode(!0)),this.log("render"),this.resetContext(),this._rendered=!0}},{key:"emitEvent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.bubbles,n=void 0===r||r,o=t.cancelable,r=void 0!==o&&o,o=t.composed,o=void 0!==o&&o,t=t.detail,t=void 0===t?{}:t;this.log("Custom event: "+e),this.dispatchEvent(new CustomEvent(e,{bubbles:n,cancelable:r,composed:o,detail:t}))}},{key:"cascadeProperties",value:function(e){var r,t=this,n=this._pfeClass._getCache("cascadingProperties");n&&(window.ShadyCSS&&this._cascadeObserver&&this._cascadeObserver.disconnect(),r=Object.keys(n),e&&(r=[],[].concat(c(e)).forEach(function(t){Object.keys(n).map(function(e){t.matches&&t.matches(e)&&r.push(e)})})),r&&((e=r.filter(function(e){return e.slice(0,f.length+1)===f+"-"}).map(function(e){return customElements.whenDefined(e)}))?Promise.all(e).then(function(){t._copyAttributes(r,n)}):this._copyAttributes(r,n)),window.ShadyCSS&&this._cascadeObserver&&this._cascadeObserver.observe(this,{attributes:!0,childList:!0,subtree:!0}))}},{key:"_upgradeObserver",value:function(){this.classList.add("PFElement")}},{key:"_contextObserver",value:function(e,t){t&&(e&&e!==t||!e)&&(this.on=t,this.cssVariable("context",t))}},{key:"_onObserver",value:function(e,t){(e&&e!==t||t&&!e)&&this.contextUpdate()}},{key:"_inlineStyleObserver",value:function(e,t){this.log("Style observer activated on "+this.tag);var r,t=/--(?:context|theme):\s*(?:\"*(light|dark|saturated)\"*)/gi.exec(t);t&&((r=t[1])===this.on||this.context||(this.on=r))}},{key:"_parseObserver",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var i=i.value;"childList"===i.type&&i.addedNodes.length&&this.cascadeProperties(i.addedNodes)}}catch(e){r=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw n}}}},{key:"_castPropertyValue",value:function(e,t){var r;switch(e.type){case Number:return a(r={},t,Number(t)),a(r,"null",null),a(r,"NaN",NaN),a(r,"undefined",void 0),r[t];case Boolean:return null!==t;case String:return a(r={},t,t),a(r,"undefined",void 0),r[t];default:return t}}},{key:"_assignValueToAttribute",value:function(e,t,r){e.type===Boolean&&!r||null===r||void 0===r?this.removeAttribute(t):e.type===Boolean&&"boolean"==typeof r?this.setAttribute(t,""):(e.values&&this._validateAttributeValue(e,t,r),this.setAttribute(t,r))}},{key:"_initializeSlots",value:function(o,i){var a=this;this.log("Validate slots..."),window.ShadyCSS&&this._slotsObserver&&this._slotsObserver.disconnect(),Object.keys(i).forEach(function(e){var t,r,n=i[e];"object"===(void 0===n?"undefined":s(n))&&(t=!1,r=[],n.namedSlot?(0<(r=a.getSlot(o+"--"+e)).length&&(n.nodes=r,t=!0),0<(r=a.getSlot(""+e)).length&&(n.nodes=r,t=!0)):0<(r=[].concat(c(a.children)).filter(function(e){return!e.hasAttribute("slot")})).length&&(n.nodes=r,t=!0),t?a.setAttribute("has_"+e,""):a.removeAttribute("has_"+e))}),this.log("Slots validated."),window.ShadyCSS&&this._slotsObserver&&this._slotsObserver.observe(this,{childList:!0})}},{key:"_initializeProperties",value:function(){var e,n=this,o=this._pfeClass.allProperties,i=!1;for(e in o)!function(e){var t,r=o[e];void 0!==n[e]?n.log('Property "'+e+'" on '+n.constructor.name+" cannot be defined because the property name is reserved"):(t=n._pfeClass._prop2attr(e),r.cascade&&(i=!0),Object.defineProperty(n,e,{get:function(){var e=n.getAttribute(t);return n._castPropertyValue(r,e)},set:function(e){return n._assignValueToAttribute(r,t,e),e},writeable:!0,enumerable:!0,configurable:!1}))}(e);i&&(this._cascadeObserver=new MutationObserver(this._parseObserver))}},{key:"_initializeAttributeDefaults",value:function(){var e,t=this._pfeClass.allProperties;for(e in t){var r,n=t[e],o=this._pfeClass._prop2attr(e);n.hasOwnProperty("default")&&(r=n.default,"function"==typeof n.default&&(r=n.default(this)),this.hasAttribute(o)||this._assignValueToAttribute(n,o,r))}}},{key:"_validateAttributeValue",value:function(e,t,r){return Array.isArray(e.values)&&0<e.values.length&&!e.values.includes(r)&&this.warn(r+" is not a valid value for "+t+". Please provide one of the following values: "+e.values.join(", ")),r}},{key:"_copyAttributes",value:function(e,r){var n=this;e.forEach(function(t){r[t].forEach(function(e){n._copyAttribute(e,t)})})}},{key:"_copyAttribute",value:function(e,t){var r=[].concat(c(this.querySelectorAll(t)),c(this.shadowRoot.querySelectorAll(t))),n=this.getAttribute(e),o=null==n?"removeAttribute":"setAttribute",i=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)l.value[o](e,n)}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}}}],[{key:"_validateProperties",value:function(){for(var e in this.allProperties){var t=this.allProperties[e];[String,Number,Boolean].includes(t.type||String)||this.error('Property "'+e+'" on '+this.name+" must have type String, Number, or Boolean."),/^[a-z_]/.test(e)||this.error("Property "+this.name+"."+e+" defined, but prop names must begin with a lower-case letter or an underscore");var r="function"==typeof t.default;!t.default||(n=t).hasOwnProperty("default")&&n.default.constructor===n.type||r||this.error("["+this.name+"] The default value `"+t.default+"` does not match the assigned type "+t.type.name+" for the '"+e+"' property")}var n}},{key:"_prop2attr",value:function(e){return this._getCache("prop2attr")[e]}},{key:"_attr2prop",value:function(e){return this._getCache("attr2prop")[e]}},{key:"_convertPropNameToAttrName",value:function(e){var t=this.allProperties[e];return t.attr||e.replace(/^_/,"").replace(/^[A-Z]/,function(e){return e.toLowerCase()}).replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}},{key:"_convertAttrNameToPropName",value:function(e){for(var t in this.allProperties)if(this.allProperties[t].attr===e)return t;return e.replace(/-([A-Za-z])/g,function(e){return e[1].toUpperCase()})}},{key:"_convertSelectorsToArray",value:function(e){if(e){if("string"==typeof e)return e.split(",");if("array"==typeof e||"object"===(void 0===e?"undefined":s(e)))return e;this.warn("selectors should be provided as a string, array, or object; received: "+(void 0===e?"undefined":s(e))+".")}}},{key:"_parsePropertiesForCascade",value:function(e){var n=this,o={},t=!0,r=!1,i=void 0;try{for(var a=Object.entries(e)[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var s=s.value,s=h(s,2);!function(r,e){(e=n._convertSelectorsToArray(e.cascade))&&e.map(function(e){var t=n._prop2attr(r);o[e]?o[e].push(t):o[e]=[t]})}(s[0],s[1])}}catch(e){r=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw i}}return o}},{key:"create",value:function(e){e._createCache(),e._populateCache(e),e._validateProperties(),window.customElements.define(e.tag,e)}},{key:"_createCache",value:function(){this._cache={properties:{},globalProperties:{},componentProperties:{},cascadingProperties:{},attr2prop:{},prop2attr:{}}}},{key:"_setCache",value:function(e,t){this._cache[e]=t}},{key:"_getCache",value:function(e){return e?this._cache[e]:this._cache}},{key:"_populateCache",value:function(e){var t=l({},e.properties,p.properties);e._setCache("componentProperties",e.properties),e._setCache("globalProperties",p.properties),e._setCache("properties",t);var r,n={},o={};for(r in t){var i=this._convertPropNameToAttrName(r);o[n[r]=i]=r}e._setCache("attr2prop",o),e._setCache("prop2attr",n);t=this._parsePropertiesForCascade(t);Object.keys(t)&&e._setCache("cascadingProperties",t)}},{key:"allProperties",get:function(){return this._getCache("properties")}},{key:"cascadingProperties",get:function(){return this._getCache("cascadingProperties")}}]),p);function p(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.type,n=void 0===r?null:r,r=t.delayRender,t=void 0!==r&&r;o(this,p);r=u(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));return r._pfeClass=e,r.tag=e.tag,r._parseObserver=r._parseObserver.bind(r),r.schemaProps=e.schemaProperties,r.slots=e.slots,r.template=document.createElement("template"),n&&r._pfeClass.allProperties.type&&(r._pfeClass.allProperties.type.default=n),r._initializeProperties(),r.attachShadow({mode:"open"}),r._rendered=!1,t||r.render(),r}return function(e){r=e;var t=window.WebComponents,e=t&&window.WebComponents.ready;!t||e?n():window.addEventListener("WebComponentsReady",n)}(e.log),e});
//# sourceMappingURL=pfelement.umd.min.js.map

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJwZmVsZW1lbnQvZGlzdC9wZmVsZW1lbnQudW1kLm1pbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24oZSx0KXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZSh0KTooZT1lfHxzZWxmKS5QRkVsZW1lbnQ9dCgpfSh0aGlzLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbH07ZnVuY3Rpb24gbigpe3IoXCJbcmV2ZWFsXSB3ZWIgY29tcG9uZW50cyByZWFkeVwiKSxyKFwiW3JldmVhbF0gZWxlbWVudHMgcmVhZHksIHJldmVhbGluZyB0aGUgYm9keVwiKSx3aW5kb3cuZG9jdW1lbnQuYm9keS5yZW1vdmVBdHRyaWJ1dGUoXCJ1bnJlc29sdmVkXCIpfUFycmF5LnByb3RvdHlwZS5pbmNsdWRlc3x8T2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSxcImluY2x1ZGVzXCIse3ZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYobnVsbD09dGhpcyl0aHJvdyBuZXcgVHlwZUVycm9yKCdcInRoaXNcIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7dmFyIHI9T2JqZWN0KHRoaXMpLG49ci5sZW5ndGg+Pj4wO2lmKDA9PW4pcmV0dXJuITE7dmFyIG8saSx0PTB8dCxhPU1hdGgubWF4KDA8PXQ/dDpuLU1hdGguYWJzKHQpLDApO2Zvcig7YTxuOyl7aWYoKG89clthXSk9PT0oaT1lKXx8XCJudW1iZXJcIj09dHlwZW9mIG8mJlwibnVtYmVyXCI9PXR5cGVvZiBpJiZpc05hTihvKSYmaXNOYU4oaSkpcmV0dXJuITA7YSsrfXJldHVybiExfX0pLE9iamVjdC5lbnRyaWVzfHwoT2JqZWN0LmVudHJpZXM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PU9iamVjdC5rZXlzKGUpLHI9dC5sZW5ndGgsbj1uZXcgQXJyYXkocik7ci0tOyluW3JdPVt0W3JdLGVbdFtyXV1dO3JldHVybiBufSk7dmFyIHM9XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZcInN5bWJvbFwiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yP2Z1bmN0aW9uKGUpe3JldHVybiB0eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZS5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmZSE9PVN5bWJvbC5wcm90b3R5cGU/XCJzeW1ib2xcIjp0eXBlb2YgZX0sbz1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9LGU9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0JiZpKGUucHJvdG90eXBlLHQpLHImJmkoZSxyKSxlfTtmdW5jdGlvbiBpKGUsdCl7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspe3ZhciBuPXRbcl07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLG4ua2V5LG4pfX1mdW5jdGlvbiBhKGUsdCxyKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOnIsZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPXIsZX1mdW5jdGlvbiBjKGUpe2lmKEFycmF5LmlzQXJyYXkoZSkpe2Zvcih2YXIgdD0wLHI9QXJyYXkoZS5sZW5ndGgpO3Q8ZS5sZW5ndGg7dCsrKXJbdF09ZVt0XTtyZXR1cm4gcn1yZXR1cm4gQXJyYXkuZnJvbShlKX12YXIgbD1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQ9MTt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXt2YXIgcixuPWFyZ3VtZW50c1t0XTtmb3IociBpbiBuKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChuLHIpJiYoZVtyXT1uW3JdKX1yZXR1cm4gZX0sdT1mdW5jdGlvbihlLHQpe2lmKCFlKXRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTtyZXR1cm4hdHx8XCJvYmplY3RcIiE9dHlwZW9mIHQmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHQ/ZTp0fSxoPWZ1bmN0aW9uKGUsdCl7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gZTtpZihTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGUpKXJldHVybiBmdW5jdGlvbihlLHQpe3ZhciByPVtdLG49ITAsbz0hMSxpPXZvaWQgMDt0cnl7Zm9yKHZhciBhLHM9ZVtTeW1ib2wuaXRlcmF0b3JdKCk7IShuPShhPXMubmV4dCgpKS5kb25lKSYmKHIucHVzaChhLnZhbHVlKSwhdHx8ci5sZW5ndGghPT10KTtuPSEwKTt9Y2F0Y2goZSl7bz0hMCxpPWV9ZmluYWxseXt0cnl7IW4mJnMucmV0dXJuJiZzLnJldHVybigpfWZpbmFsbHl7aWYobyl0aHJvdyBpfX1yZXR1cm4gcn0oZSx0KTt0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZVwiKX0sZj1cInBmZVwiLGU9KGZ1bmN0aW9uKGUsdCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIrdHlwZW9mIHQpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodCYmdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTplLGVudW1lcmFibGU6ITEsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLHQmJihPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKGUsdCk6ZS5fX3Byb3RvX189dCl9KHAsSFRNTEVsZW1lbnQpLGUocCxbe2tleTpcImxvZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1BcnJheShlKSxyPTA7cjxlO3IrKyl0W3JdPWFyZ3VtZW50c1tyXTtwLmxvZyhcIltcIit0aGlzLnRhZysodGhpcy5pZD9cIiNcIit0aGlzLmlkOlwiXCIpK1wiXTogXCIrdC5qb2luKFwiLCBcIikpfX0se2tleTpcIndhcm5cIix2YWx1ZTpmdW5jdGlvbigpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoLHQ9QXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cC53YXJuKFwiW1wiK3RoaXMudGFnKyh0aGlzLmlkP1wiI1wiK3RoaXMuaWQ6XCJcIikrXCJdOiBcIit0LmpvaW4oXCIsIFwiKSl9fSx7a2V5OlwiZXJyb3JcIix2YWx1ZTpmdW5jdGlvbigpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoLHQ9QXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cC5lcnJvci5hcHBseShwLFtcIltcIit0aGlzLnRhZysodGhpcy5pZD9cIiNcIit0aGlzLmlkOlwiXCIpK1wiXTpcIl0uY29uY2F0KHQpKX19LHtrZXk6XCJoYXNMaWdodERPTVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hpbGRyZW4ubGVuZ3RofHx0aGlzLnRleHRDb250ZW50LnRyaW0oKS5sZW5ndGh9fSx7a2V5OlwiaGFzU2xvdFwiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYodClzd2l0Y2godm9pZCAwPT09dD9cInVuZGVmaW5lZFwiOnModCkpe2Nhc2VcInN0cmluZ1wiOnJldHVybiAwPFtdLmNvbmNhdChjKHRoaXMuY2hpbGRyZW4pKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIGUuaGFzQXR0cmlidXRlKFwic2xvdFwiKSYmZS5nZXRBdHRyaWJ1dGUoXCJzbG90XCIpPT09dH0pLmxlbmd0aDtjYXNlXCJhcnJheVwiOnJldHVybiB0LnJlZHVjZShmdW5jdGlvbih0KXtyZXR1cm4gMDxbXS5jb25jYXQoYyhlLmNoaWxkcmVuKSkuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLmhhc0F0dHJpYnV0ZShcInNsb3RcIikmJmUuZ2V0QXR0cmlidXRlKFwic2xvdFwiKT09PXR9KS5sZW5ndGh9KTtkZWZhdWx0OnJldHVybiB2b2lkIHRoaXMud2FybihcIkRpZCBub3QgcmVjb2duaXplIHRoZSB0eXBlIG9mIHRoZSBuYW1lIHByb3ZpZGVkIHRvIGhhc1Nsb3Q7IHRoaXMgZnVuY2l0b24gY2FuIGFjY2VwdCBhIHN0cmluZyBvciBhbiBhcnJheS5cIil9ZWxzZSB0aGlzLndhcm4oXCJQbGVhc2UgcHJvdmlkZSBhdCBsZWFzdCBvbmUgc2xvdCBuYW1lIGZvciB3aGljaCB0byBzZWFyY2guXCIpfX0se2tleTpcImdldFNsb3RcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0PTA8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpcInVuYXNzaWduZWRcIjtyZXR1cm5cInVuYXNzaWduZWRcIiE9PXQ/W10uY29uY2F0KGModGhpcy5jaGlsZHJlbikpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gZS5oYXNBdHRyaWJ1dGUoXCJzbG90XCIpJiZlLmdldEF0dHJpYnV0ZShcInNsb3RcIik9PT10fSk6W10uY29uY2F0KGModGhpcy5jaGlsZHJlbikpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4hZS5oYXNBdHRyaWJ1dGUoXCJzbG90XCIpfSl9fSx7a2V5OlwiY3NzVmFyaWFibGVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTp0aGlzO3JldHVybiBlPVwiLS1cIiE9PWUuc3Vic3RyKDAsMik/XCItLVwiK2U6ZSx0PyhyLnN0eWxlLnNldFByb3BlcnR5KGUsdCksdCk6d2luZG93LmdldENvbXB1dGVkU3R5bGUocikuZ2V0UHJvcGVydHlWYWx1ZShlKS50cmltKCl8fG51bGx9fSx7a2V5OlwiY29udGV4dFVwZGF0ZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztbXS5jb25jYXQoYyh0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIqXCIpKSxjKHRoaXMuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yQWxsKFwiKlwiKSkpLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkuc2xpY2UoMCw0KT09PWYrXCItXCJ9KS5tYXAoZnVuY3Rpb24oZSl7dC5sb2coXCJVcGRhdGUgY29udGV4dCBvZiBcIitlLnRhZyksUHJvbWlzZS5hbGwoW2N1c3RvbUVsZW1lbnRzLndoZW5EZWZpbmVkKGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpKV0pLnRoZW4oZnVuY3Rpb24oKXtlLnJlc2V0Q29udGV4dCh0Lm9uKX0pfSl9fSx7a2V5OlwicmVzZXRDb250ZXh0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5sb2coXCJSZXNldHRpbmcgY29udGV4dCBvbiBcIit0aGlzLnRhZyk7ZT10aGlzLmNvbnRleHR8fHRoaXMuY29udGV4dFZhcmlhYmxlfHxlO3RoaXMub249ZX19LHtrZXk6XCJ2ZXJzaW9uXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BmZUNsYXNzLnZlcnNpb259fSx7a2V5OlwicmFuZG9tSWRcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZitcIi1cIitNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiw5KX19LHtrZXk6XCJjb250ZXh0VmFyaWFibGVcIixzZXQ6ZnVuY3Rpb24oZSl7dGhpcy5jc3NWYXJpYWJsZShcImNvbnRleHRcIixlKX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY3NzVmFyaWFibGUoXCJjb250ZXh0XCIpfHx0aGlzLmNzc1ZhcmlhYmxlKFwidGhlbWVcIil9fV0sW3trZXk6XCJkZWJ1Z0xvZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9MDxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOm51bGw7cmV0dXJuIHAuX2RlYnVnTG9nPW51bGwhPT1lPyEhZTpwLl9kZWJ1Z0xvZ319LHtrZXk6XCJsb2dcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO3AuZGVidWdMb2coKSYmKGU9Y29uc29sZSkubG9nLmFwcGx5KGUsYXJndW1lbnRzKX19LHtrZXk6XCJ3YXJuXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTsoZT1jb25zb2xlKS53YXJuLmFwcGx5KGUsYXJndW1lbnRzKX19LHtrZXk6XCJlcnJvclwiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1BcnJheShlKSxyPTA7cjxlO3IrKyl0W3JdPWFyZ3VtZW50c1tyXTt0aHJvdyBuZXcgRXJyb3IoW10uY29uY2F0KHQpLmpvaW4oXCIgXCIpKX19LHtrZXk6XCJQZmVUeXBlc1wiLGdldDpmdW5jdGlvbigpe3JldHVybntDb250YWluZXI6XCJjb250YWluZXJcIixDb250ZW50OlwiY29udGVudFwiLENvbWJvOlwiY29tYm9cIn19fSx7a2V5OlwidmVyc2lvblwiLGdldDpmdW5jdGlvbigpe3JldHVyblwie3t2ZXJzaW9ufX1cIn19LHtrZXk6XCJwcm9wZXJ0aWVzXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJue3BmZWxlbWVudDp7dGl0bGU6XCJVcGdyYWRlZCBmbGFnXCIsdHlwZTpCb29sZWFuLGRlZmF1bHQ6ITAsb2JzZXJ2ZXI6XCJfdXBncmFkZU9ic2VydmVyXCJ9LG9uOnt0aXRsZTpcIkNvbnRleHRcIixkZXNjcmlwdGlvbjpcIkRlc2NyaWJlcyB0aGUgdmlzdWFsIGNvbnRleHQgKGJhY2tncm91bmRzKS5cIix0eXBlOlN0cmluZyx2YWx1ZXM6W1wibGlnaHRcIixcImRhcmtcIixcInNhdHVyYXRlZFwiXSxkZWZhdWx0OmZ1bmN0aW9uKGUpe3JldHVybiBlLmNvbnRleHRWYXJpYWJsZX0sb2JzZXJ2ZXI6XCJfb25PYnNlcnZlclwifSxjb250ZXh0Ont0aXRsZTpcIkNvbnRleHQgaG9va1wiLGRlc2NyaXB0aW9uOlwiTGV0cyB5b3Ugb3ZlcnJpZGUgdGhlIHN5c3RlbS1zZXQgY29udGV4dC5cIix0eXBlOlN0cmluZyx2YWx1ZXM6W1wibGlnaHRcIixcImRhcmtcIixcInNhdHVyYXRlZFwiXSxvYnNlcnZlcjpcIl9jb250ZXh0T2JzZXJ2ZXJcIn0sb2xkVGhlbWU6e3R5cGU6U3RyaW5nLHZhbHVlczpbXCJsaWdodFwiLFwiZGFya1wiLFwic2F0dXJhdGVkXCJdLGFsaWFzOlwiY29udGV4dFwiLGF0dHI6XCJwZmUtdGhlbWVcIn0sX3N0eWxlOnt0aXRsZTpcIkN1c3RvbSBzdHlsZXNcIix0eXBlOlN0cmluZyxhdHRyOlwic3R5bGVcIixvYnNlcnZlcjpcIl9pbmxpbmVTdHlsZU9ic2VydmVyXCJ9LHR5cGU6e3RpdGxlOlwiQ29tcG9uZW50IHR5cGVcIix0eXBlOlN0cmluZyx2YWx1ZXM6W1wiY29udGFpbmVyXCIsXCJjb250ZW50XCIsXCJjb21ib1wiXX19fX0se2tleTpcIm9ic2VydmVkQXR0cmlidXRlc1wiLGdldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMscj10aGlzLmFsbFByb3BlcnRpZXM7aWYocil7dmFyIGU9T2JqZWN0LmtleXMocikuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiByW2VdLm9ic2VydmVyfHxyW2VdLmNhc2NhZGV8fHJbZV0uYWxpYXN9KS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnRQcm9wTmFtZVRvQXR0ck5hbWUoZSl9KTtyZXR1cm5bXS5jb25jYXQoYyhlKSl9fX1dKSxlKHAsW3trZXk6XCJjb25uZWN0ZWRDYWxsYmFja1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9pbml0aWFsaXplQXR0cmlidXRlRGVmYXVsdHMoKSx3aW5kb3cuU2hhZHlDU1MmJndpbmRvdy5TaGFkeUNTUy5zdHlsZUVsZW1lbnQodGhpcyksXCJvYmplY3RcIj09PXModGhpcy5zbG90cykmJih0aGlzLl9zbG90c09ic2VydmVyPW5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKCl7cmV0dXJuIGUuX2luaXRpYWxpemVTbG90cyhlLnRhZyxlLnNsb3RzKX0pLHRoaXMuX3Nsb3RzT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLHtjaGlsZExpc3Q6ITB9KSx0aGlzLl9pbml0aWFsaXplU2xvdHModGhpcy50YWcsdGhpcy5zbG90cykpLHRoaXMuX2Nhc2NhZGVPYnNlcnZlciYmdGhpcy5fY2FzY2FkZU9ic2VydmVyLm9ic2VydmUodGhpcyx7YXR0cmlidXRlczohMCxjaGlsZExpc3Q6ITAsc3VidHJlZTohMH0pfX0se2tleTpcImRpc2Nvbm5lY3RlZENhbGxiYWNrXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jYXNjYWRlT2JzZXJ2ZXImJnRoaXMuX2Nhc2NhZGVPYnNlcnZlci5kaXNjb25uZWN0KCksdGhpcy5fc2xvdHNPYnNlcnZlciYmdGhpcy5fc2xvdHNPYnNlcnZlci5kaXNjb25uZWN0KCl9fSx7a2V5OlwiYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBuLG8saTt0aGlzLl9wZmVDbGFzcy5hbGxQcm9wZXJ0aWVzJiYoaT10aGlzLl9wZmVDbGFzcy5fYXR0cjJwcm9wKGUpLChuPXRoaXMuX3BmZUNsYXNzLmFsbFByb3BlcnRpZXNbaV0pJiYobi5hbGlhcyYmKG89dGhpcy5fcGZlQ2xhc3MuYWxsUHJvcGVydGllc1tuLmFsaWFzXSxpPXRoaXMuX3BmZUNsYXNzLl9wcm9wMmF0dHIobi5hbGlhcyksdGhpcy5nZXRBdHRyaWJ1dGUoaSkhPT1yJiYodGhpc1tuLmFsaWFzXT10aGlzLl9jYXN0UHJvcGVydHlWYWx1ZShvLHIpKSksbi5vYnNlcnZlciYmdGhpc1tuLm9ic2VydmVyXSh0aGlzLl9jYXN0UHJvcGVydHlWYWx1ZShuLHQpLHRoaXMuX2Nhc3RQcm9wZXJ0eVZhbHVlKG4scikpLG4uY2FzY2FkZSYmdGhpcy5fY29weUF0dHJpYnV0ZShlLHRoaXMuX3BmZUNsYXNzLl9jb252ZXJ0U2VsZWN0b3JzVG9BcnJheShuLmNhc2NhZGUpKSkpfX0se2tleTpcInJlbmRlclwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5zaGFkb3dSb290LmlubmVySFRNTD1cIlwiLHRoaXMudGVtcGxhdGUuaW5uZXJIVE1MPXRoaXMuaHRtbCx3aW5kb3cuU2hhZHlDU1MmJndpbmRvdy5TaGFkeUNTUy5wcmVwYXJlVGVtcGxhdGUodGhpcy50ZW1wbGF0ZSx0aGlzLnRhZyksdGhpcy5zaGFkb3dSb290LmFwcGVuZENoaWxkKHRoaXMudGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUoITApKSx0aGlzLmxvZyhcInJlbmRlclwiKSx0aGlzLnJlc2V0Q29udGV4dCgpLHRoaXMuX3JlbmRlcmVkPSEwfX0se2tleTpcImVtaXRFdmVudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTp7fSxyPXQuYnViYmxlcyxuPXZvaWQgMD09PXJ8fHIsbz10LmNhbmNlbGFibGUscj12b2lkIDAhPT1vJiZvLG89dC5jb21wb3NlZCxvPXZvaWQgMCE9PW8mJm8sdD10LmRldGFpbCx0PXZvaWQgMD09PXQ/e306dDt0aGlzLmxvZyhcIkN1c3RvbSBldmVudDogXCIrZSksdGhpcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChlLHtidWJibGVzOm4sY2FuY2VsYWJsZTpyLGNvbXBvc2VkOm8sZGV0YWlsOnR9KSl9fSx7a2V5OlwiY2FzY2FkZVByb3BlcnRpZXNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgcix0PXRoaXMsbj10aGlzLl9wZmVDbGFzcy5fZ2V0Q2FjaGUoXCJjYXNjYWRpbmdQcm9wZXJ0aWVzXCIpO24mJih3aW5kb3cuU2hhZHlDU1MmJnRoaXMuX2Nhc2NhZGVPYnNlcnZlciYmdGhpcy5fY2FzY2FkZU9ic2VydmVyLmRpc2Nvbm5lY3QoKSxyPU9iamVjdC5rZXlzKG4pLGUmJihyPVtdLFtdLmNvbmNhdChjKGUpKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe09iamVjdC5rZXlzKG4pLm1hcChmdW5jdGlvbihlKXt0Lm1hdGNoZXMmJnQubWF0Y2hlcyhlKSYmci5wdXNoKGUpfSl9KSksciYmKChlPXIuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiBlLnNsaWNlKDAsZi5sZW5ndGgrMSk9PT1mK1wiLVwifSkubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBjdXN0b21FbGVtZW50cy53aGVuRGVmaW5lZChlKX0pKT9Qcm9taXNlLmFsbChlKS50aGVuKGZ1bmN0aW9uKCl7dC5fY29weUF0dHJpYnV0ZXMocixuKX0pOnRoaXMuX2NvcHlBdHRyaWJ1dGVzKHIsbikpLHdpbmRvdy5TaGFkeUNTUyYmdGhpcy5fY2FzY2FkZU9ic2VydmVyJiZ0aGlzLl9jYXNjYWRlT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLHthdHRyaWJ1dGVzOiEwLGNoaWxkTGlzdDohMCxzdWJ0cmVlOiEwfSkpfX0se2tleTpcIl91cGdyYWRlT2JzZXJ2ZXJcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuY2xhc3NMaXN0LmFkZChcIlBGRWxlbWVudFwiKX19LHtrZXk6XCJfY29udGV4dE9ic2VydmVyXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0JiYoZSYmZSE9PXR8fCFlKSYmKHRoaXMub249dCx0aGlzLmNzc1ZhcmlhYmxlKFwiY29udGV4dFwiLHQpKX19LHtrZXk6XCJfb25PYnNlcnZlclwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7KGUmJmUhPT10fHx0JiYhZSkmJnRoaXMuY29udGV4dFVwZGF0ZSgpfX0se2tleTpcIl9pbmxpbmVTdHlsZU9ic2VydmVyXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLmxvZyhcIlN0eWxlIG9ic2VydmVyIGFjdGl2YXRlZCBvbiBcIit0aGlzLnRhZyk7dmFyIHIsdD0vLS0oPzpjb250ZXh0fHRoZW1lKTpcXHMqKD86XFxcIioobGlnaHR8ZGFya3xzYXR1cmF0ZWQpXFxcIiopL2dpLmV4ZWModCk7dCYmKChyPXRbMV0pPT09dGhpcy5vbnx8dGhpcy5jb250ZXh0fHwodGhpcy5vbj1yKSl9fSx7a2V5OlwiX3BhcnNlT2JzZXJ2ZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0hMCxyPSExLG49dm9pZCAwO3RyeXtmb3IodmFyIG89ZVtTeW1ib2wuaXRlcmF0b3JdKCk7ISh0PShpPW8ubmV4dCgpKS5kb25lKTt0PSEwKXt2YXIgaT1pLnZhbHVlO1wiY2hpbGRMaXN0XCI9PT1pLnR5cGUmJmkuYWRkZWROb2Rlcy5sZW5ndGgmJnRoaXMuY2FzY2FkZVByb3BlcnRpZXMoaS5hZGRlZE5vZGVzKX19Y2F0Y2goZSl7cj0hMCxuPWV9ZmluYWxseXt0cnl7IXQmJm8ucmV0dXJuJiZvLnJldHVybigpfWZpbmFsbHl7aWYocil0aHJvdyBufX19fSx7a2V5OlwiX2Nhc3RQcm9wZXJ0eVZhbHVlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcjtzd2l0Y2goZS50eXBlKXtjYXNlIE51bWJlcjpyZXR1cm4gYShyPXt9LHQsTnVtYmVyKHQpKSxhKHIsXCJudWxsXCIsbnVsbCksYShyLFwiTmFOXCIsTmFOKSxhKHIsXCJ1bmRlZmluZWRcIix2b2lkIDApLHJbdF07Y2FzZSBCb29sZWFuOnJldHVybiBudWxsIT09dDtjYXNlIFN0cmluZzpyZXR1cm4gYShyPXt9LHQsdCksYShyLFwidW5kZWZpbmVkXCIsdm9pZCAwKSxyW3RdO2RlZmF1bHQ6cmV0dXJuIHR9fX0se2tleTpcIl9hc3NpZ25WYWx1ZVRvQXR0cmlidXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe2UudHlwZT09PUJvb2xlYW4mJiFyfHxudWxsPT09cnx8dm9pZCAwPT09cj90aGlzLnJlbW92ZUF0dHJpYnV0ZSh0KTplLnR5cGU9PT1Cb29sZWFuJiZcImJvb2xlYW5cIj09dHlwZW9mIHI/dGhpcy5zZXRBdHRyaWJ1dGUodCxcIlwiKTooZS52YWx1ZXMmJnRoaXMuX3ZhbGlkYXRlQXR0cmlidXRlVmFsdWUoZSx0LHIpLHRoaXMuc2V0QXR0cmlidXRlKHQscikpfX0se2tleTpcIl9pbml0aWFsaXplU2xvdHNcIix2YWx1ZTpmdW5jdGlvbihvLGkpe3ZhciBhPXRoaXM7dGhpcy5sb2coXCJWYWxpZGF0ZSBzbG90cy4uLlwiKSx3aW5kb3cuU2hhZHlDU1MmJnRoaXMuX3Nsb3RzT2JzZXJ2ZXImJnRoaXMuX3Nsb3RzT2JzZXJ2ZXIuZGlzY29ubmVjdCgpLE9iamVjdC5rZXlzKGkpLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQscixuPWlbZV07XCJvYmplY3RcIj09PSh2b2lkIDA9PT1uP1widW5kZWZpbmVkXCI6cyhuKSkmJih0PSExLHI9W10sbi5uYW1lZFNsb3Q/KDA8KHI9YS5nZXRTbG90KG8rXCItLVwiK2UpKS5sZW5ndGgmJihuLm5vZGVzPXIsdD0hMCksMDwocj1hLmdldFNsb3QoXCJcIitlKSkubGVuZ3RoJiYobi5ub2Rlcz1yLHQ9ITApKTowPChyPVtdLmNvbmNhdChjKGEuY2hpbGRyZW4pKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIWUuaGFzQXR0cmlidXRlKFwic2xvdFwiKX0pKS5sZW5ndGgmJihuLm5vZGVzPXIsdD0hMCksdD9hLnNldEF0dHJpYnV0ZShcImhhc19cIitlLFwiXCIpOmEucmVtb3ZlQXR0cmlidXRlKFwiaGFzX1wiK2UpKX0pLHRoaXMubG9nKFwiU2xvdHMgdmFsaWRhdGVkLlwiKSx3aW5kb3cuU2hhZHlDU1MmJnRoaXMuX3Nsb3RzT2JzZXJ2ZXImJnRoaXMuX3Nsb3RzT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLHtjaGlsZExpc3Q6ITB9KX19LHtrZXk6XCJfaW5pdGlhbGl6ZVByb3BlcnRpZXNcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLG49dGhpcyxvPXRoaXMuX3BmZUNsYXNzLmFsbFByb3BlcnRpZXMsaT0hMTtmb3IoZSBpbiBvKSFmdW5jdGlvbihlKXt2YXIgdCxyPW9bZV07dm9pZCAwIT09bltlXT9uLmxvZygnUHJvcGVydHkgXCInK2UrJ1wiIG9uICcrbi5jb25zdHJ1Y3Rvci5uYW1lK1wiIGNhbm5vdCBiZSBkZWZpbmVkIGJlY2F1c2UgdGhlIHByb3BlcnR5IG5hbWUgaXMgcmVzZXJ2ZWRcIik6KHQ9bi5fcGZlQ2xhc3MuX3Byb3AyYXR0cihlKSxyLmNhc2NhZGUmJihpPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixlLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT1uLmdldEF0dHJpYnV0ZSh0KTtyZXR1cm4gbi5fY2FzdFByb3BlcnR5VmFsdWUocixlKX0sc2V0OmZ1bmN0aW9uKGUpe3JldHVybiBuLl9hc3NpZ25WYWx1ZVRvQXR0cmlidXRlKHIsdCxlKSxlfSx3cml0ZWFibGU6ITAsZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITF9KSl9KGUpO2kmJih0aGlzLl9jYXNjYWRlT2JzZXJ2ZXI9bmV3IE11dGF0aW9uT2JzZXJ2ZXIodGhpcy5fcGFyc2VPYnNlcnZlcikpfX0se2tleTpcIl9pbml0aWFsaXplQXR0cmlidXRlRGVmYXVsdHNcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcy5fcGZlQ2xhc3MuYWxsUHJvcGVydGllcztmb3IoZSBpbiB0KXt2YXIgcixuPXRbZV0sbz10aGlzLl9wZmVDbGFzcy5fcHJvcDJhdHRyKGUpO24uaGFzT3duUHJvcGVydHkoXCJkZWZhdWx0XCIpJiYocj1uLmRlZmF1bHQsXCJmdW5jdGlvblwiPT10eXBlb2Ygbi5kZWZhdWx0JiYocj1uLmRlZmF1bHQodGhpcykpLHRoaXMuaGFzQXR0cmlidXRlKG8pfHx0aGlzLl9hc3NpZ25WYWx1ZVRvQXR0cmlidXRlKG4sbyxyKSl9fX0se2tleTpcIl92YWxpZGF0ZUF0dHJpYnV0ZVZhbHVlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBBcnJheS5pc0FycmF5KGUudmFsdWVzKSYmMDxlLnZhbHVlcy5sZW5ndGgmJiFlLnZhbHVlcy5pbmNsdWRlcyhyKSYmdGhpcy53YXJuKHIrXCIgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIFwiK3QrXCIuIFBsZWFzZSBwcm92aWRlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlczogXCIrZS52YWx1ZXMuam9pbihcIiwgXCIpKSxyfX0se2tleTpcIl9jb3B5QXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUscil7dmFyIG49dGhpcztlLmZvckVhY2goZnVuY3Rpb24odCl7clt0XS5mb3JFYWNoKGZ1bmN0aW9uKGUpe24uX2NvcHlBdHRyaWJ1dGUoZSx0KX0pfSl9fSx7a2V5OlwiX2NvcHlBdHRyaWJ1dGVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPVtdLmNvbmNhdChjKHRoaXMucXVlcnlTZWxlY3RvckFsbCh0KSksYyh0aGlzLnNoYWRvd1Jvb3QucXVlcnlTZWxlY3RvckFsbCh0KSkpLG49dGhpcy5nZXRBdHRyaWJ1dGUoZSksbz1udWxsPT1uP1wicmVtb3ZlQXR0cmlidXRlXCI6XCJzZXRBdHRyaWJ1dGVcIixpPSEwLGE9ITEscz12b2lkIDA7dHJ5e2Zvcih2YXIgbCx1PXJbU3ltYm9sLml0ZXJhdG9yXSgpOyEoaT0obD11Lm5leHQoKSkuZG9uZSk7aT0hMClsLnZhbHVlW29dKGUsbil9Y2F0Y2goZSl7YT0hMCxzPWV9ZmluYWxseXt0cnl7IWkmJnUucmV0dXJuJiZ1LnJldHVybigpfWZpbmFsbHl7aWYoYSl0aHJvdyBzfX19fV0sW3trZXk6XCJfdmFsaWRhdGVQcm9wZXJ0aWVzXCIsdmFsdWU6ZnVuY3Rpb24oKXtmb3IodmFyIGUgaW4gdGhpcy5hbGxQcm9wZXJ0aWVzKXt2YXIgdD10aGlzLmFsbFByb3BlcnRpZXNbZV07W1N0cmluZyxOdW1iZXIsQm9vbGVhbl0uaW5jbHVkZXModC50eXBlfHxTdHJpbmcpfHx0aGlzLmVycm9yKCdQcm9wZXJ0eSBcIicrZSsnXCIgb24gJyt0aGlzLm5hbWUrXCIgbXVzdCBoYXZlIHR5cGUgU3RyaW5nLCBOdW1iZXIsIG9yIEJvb2xlYW4uXCIpLC9eW2Etel9dLy50ZXN0KGUpfHx0aGlzLmVycm9yKFwiUHJvcGVydHkgXCIrdGhpcy5uYW1lK1wiLlwiK2UrXCIgZGVmaW5lZCwgYnV0IHByb3AgbmFtZXMgbXVzdCBiZWdpbiB3aXRoIGEgbG93ZXItY2FzZSBsZXR0ZXIgb3IgYW4gdW5kZXJzY29yZVwiKTt2YXIgcj1cImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmRlZmF1bHQ7IXQuZGVmYXVsdHx8KG49dCkuaGFzT3duUHJvcGVydHkoXCJkZWZhdWx0XCIpJiZuLmRlZmF1bHQuY29uc3RydWN0b3I9PT1uLnR5cGV8fHJ8fHRoaXMuZXJyb3IoXCJbXCIrdGhpcy5uYW1lK1wiXSBUaGUgZGVmYXVsdCB2YWx1ZSBgXCIrdC5kZWZhdWx0K1wiYCBkb2VzIG5vdCBtYXRjaCB0aGUgYXNzaWduZWQgdHlwZSBcIit0LnR5cGUubmFtZStcIiBmb3IgdGhlICdcIitlK1wiJyBwcm9wZXJ0eVwiKX12YXIgbn19LHtrZXk6XCJfcHJvcDJhdHRyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldENhY2hlKFwicHJvcDJhdHRyXCIpW2VdfX0se2tleTpcIl9hdHRyMnByb3BcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0Q2FjaGUoXCJhdHRyMnByb3BcIilbZV19fSx7a2V5OlwiX2NvbnZlcnRQcm9wTmFtZVRvQXR0ck5hbWVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmFsbFByb3BlcnRpZXNbZV07cmV0dXJuIHQuYXR0cnx8ZS5yZXBsYWNlKC9eXy8sXCJcIikucmVwbGFjZSgvXltBLVpdLyxmdW5jdGlvbihlKXtyZXR1cm4gZS50b0xvd2VyQ2FzZSgpfSkucmVwbGFjZSgvW0EtWl0vZyxmdW5jdGlvbihlKXtyZXR1cm5cIi1cIitlLnRvTG93ZXJDYXNlKCl9KX19LHtrZXk6XCJfY29udmVydEF0dHJOYW1lVG9Qcm9wTmFtZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiB0aGlzLmFsbFByb3BlcnRpZXMpaWYodGhpcy5hbGxQcm9wZXJ0aWVzW3RdLmF0dHI9PT1lKXJldHVybiB0O3JldHVybiBlLnJlcGxhY2UoLy0oW0EtWmEtel0pL2csZnVuY3Rpb24oZSl7cmV0dXJuIGVbMV0udG9VcHBlckNhc2UoKX0pfX0se2tleTpcIl9jb252ZXJ0U2VsZWN0b3JzVG9BcnJheVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXJldHVybiBlLnNwbGl0KFwiLFwiKTtpZihcImFycmF5XCI9PXR5cGVvZiBlfHxcIm9iamVjdFwiPT09KHZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjpzKGUpKSlyZXR1cm4gZTt0aGlzLndhcm4oXCJzZWxlY3RvcnMgc2hvdWxkIGJlIHByb3ZpZGVkIGFzIGEgc3RyaW5nLCBhcnJheSwgb3Igb2JqZWN0OyByZWNlaXZlZDogXCIrKHZvaWQgMD09PWU/XCJ1bmRlZmluZWRcIjpzKGUpKStcIi5cIil9fX0se2tleTpcIl9wYXJzZVByb3BlcnRpZXNGb3JDYXNjYWRlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49dGhpcyxvPXt9LHQ9ITAscj0hMSxpPXZvaWQgMDt0cnl7Zm9yKHZhciBhPU9iamVjdC5lbnRyaWVzKGUpW1N5bWJvbC5pdGVyYXRvcl0oKTshKHQ9KHM9YS5uZXh0KCkpLmRvbmUpO3Q9ITApe3ZhciBzPXMudmFsdWUscz1oKHMsMik7IWZ1bmN0aW9uKHIsZSl7KGU9bi5fY29udmVydFNlbGVjdG9yc1RvQXJyYXkoZS5jYXNjYWRlKSkmJmUubWFwKGZ1bmN0aW9uKGUpe3ZhciB0PW4uX3Byb3AyYXR0cihyKTtvW2VdP29bZV0ucHVzaCh0KTpvW2VdPVt0XX0pfShzWzBdLHNbMV0pfX1jYXRjaChlKXtyPSEwLGk9ZX1maW5hbGx5e3RyeXshdCYmYS5yZXR1cm4mJmEucmV0dXJuKCl9ZmluYWxseXtpZihyKXRocm93IGl9fXJldHVybiBvfX0se2tleTpcImNyZWF0ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UuX2NyZWF0ZUNhY2hlKCksZS5fcG9wdWxhdGVDYWNoZShlKSxlLl92YWxpZGF0ZVByb3BlcnRpZXMoKSx3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKGUudGFnLGUpfX0se2tleTpcIl9jcmVhdGVDYWNoZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fY2FjaGU9e3Byb3BlcnRpZXM6e30sZ2xvYmFsUHJvcGVydGllczp7fSxjb21wb25lbnRQcm9wZXJ0aWVzOnt9LGNhc2NhZGluZ1Byb3BlcnRpZXM6e30sYXR0cjJwcm9wOnt9LHByb3AyYXR0cjp7fX19fSx7a2V5OlwiX3NldENhY2hlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9jYWNoZVtlXT10fX0se2tleTpcIl9nZXRDYWNoZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlP3RoaXMuX2NhY2hlW2VdOnRoaXMuX2NhY2hlfX0se2tleTpcIl9wb3B1bGF0ZUNhY2hlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bCh7fSxlLnByb3BlcnRpZXMscC5wcm9wZXJ0aWVzKTtlLl9zZXRDYWNoZShcImNvbXBvbmVudFByb3BlcnRpZXNcIixlLnByb3BlcnRpZXMpLGUuX3NldENhY2hlKFwiZ2xvYmFsUHJvcGVydGllc1wiLHAucHJvcGVydGllcyksZS5fc2V0Q2FjaGUoXCJwcm9wZXJ0aWVzXCIsdCk7dmFyIHIsbj17fSxvPXt9O2ZvcihyIGluIHQpe3ZhciBpPXRoaXMuX2NvbnZlcnRQcm9wTmFtZVRvQXR0ck5hbWUocik7b1tuW3JdPWldPXJ9ZS5fc2V0Q2FjaGUoXCJhdHRyMnByb3BcIixvKSxlLl9zZXRDYWNoZShcInByb3AyYXR0clwiLG4pO3Q9dGhpcy5fcGFyc2VQcm9wZXJ0aWVzRm9yQ2FzY2FkZSh0KTtPYmplY3Qua2V5cyh0KSYmZS5fc2V0Q2FjaGUoXCJjYXNjYWRpbmdQcm9wZXJ0aWVzXCIsdCl9fSx7a2V5OlwiYWxsUHJvcGVydGllc1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRDYWNoZShcInByb3BlcnRpZXNcIil9fSx7a2V5OlwiY2FzY2FkaW5nUHJvcGVydGllc1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRDYWNoZShcImNhc2NhZGluZ1Byb3BlcnRpZXNcIil9fV0pLHApO2Z1bmN0aW9uIHAoZSl7dmFyIHQ9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9LHI9dC50eXBlLG49dm9pZCAwPT09cj9udWxsOnIscj10LmRlbGF5UmVuZGVyLHQ9dm9pZCAwIT09ciYmcjtvKHRoaXMscCk7cj11KHRoaXMsKHAuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YocCkpLmNhbGwodGhpcykpO3JldHVybiByLl9wZmVDbGFzcz1lLHIudGFnPWUudGFnLHIuX3BhcnNlT2JzZXJ2ZXI9ci5fcGFyc2VPYnNlcnZlci5iaW5kKHIpLHIuc2NoZW1hUHJvcHM9ZS5zY2hlbWFQcm9wZXJ0aWVzLHIuc2xvdHM9ZS5zbG90cyxyLnRlbXBsYXRlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZW1wbGF0ZVwiKSxuJiZyLl9wZmVDbGFzcy5hbGxQcm9wZXJ0aWVzLnR5cGUmJihyLl9wZmVDbGFzcy5hbGxQcm9wZXJ0aWVzLnR5cGUuZGVmYXVsdD1uKSxyLl9pbml0aWFsaXplUHJvcGVydGllcygpLHIuYXR0YWNoU2hhZG93KHttb2RlOlwib3BlblwifSksci5fcmVuZGVyZWQ9ITEsdHx8ci5yZW5kZXIoKSxyfXJldHVybiBmdW5jdGlvbihlKXtyPWU7dmFyIHQ9d2luZG93LldlYkNvbXBvbmVudHMsZT10JiZ3aW5kb3cuV2ViQ29tcG9uZW50cy5yZWFkeTshdHx8ZT9uKCk6d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJXZWJDb21wb25lbnRzUmVhZHlcIixuKX0oZS5sb2cpLGV9KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBmZWxlbWVudC51bWQubWluLmpzLm1hcFxuIl0sImZpbGUiOiJwZmVsZW1lbnQvZGlzdC9wZmVsZW1lbnQudW1kLm1pbi5qcyJ9
